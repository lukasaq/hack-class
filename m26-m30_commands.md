

---

## 1. Use NIST Best Practices for Incident Response

**Workflow Steps:**
1. Log in to the Virtual Machine (VM) win-hunt using the following credentials:
   - Username: trainee
   - Password: CyberTraining1!

2. Open the Process Monitor (Procmon64) shortcut located on the desktop. Select Run, and select Yes.
   - **Explanation:** Procmon is part of Windows Sysinternals and records live file system activity.

3. Minimize Procmon, and return to the desktop. Select Lab1.exe, located on the desktop.

4. Close the malware notification.

5. Return to Procmon. Select Filter on the menu task bar, and select Filter on the drop-down menu. In the Process Monitor Filter window that appears, select Process Name, and enter Lab1.exe as the search filter, then Add.
   - **Explanation:**  
     - **Filter:** Process Name is set to Lab1.exe  
     - This shows only events generated by the Lab1.exe process, helping focus on the malware’s activity.

6. Scroll down the filtered output list, and analyze the results displaying interactions with the registry, created file activity, and network connections.

7. Close Procmon.

8. Open tcpview64, located on the desktop, to further analyze network connections from the MCA. Select Yes to open the application when prompted.
   - **Explanation:** TCPView shows active TCP and UDP connections.

9. In the TCPView search box, enter Lab1.exe to filter the network connections toward the MCA.
   - **Filter:** Only network connections initiated or owned by Lab1.exe are displayed.

10. Make a note of the remote IP address and port.

11. Open Autoruns64, located on the desktop. Select Run to continue. If administrative rights are requested, select Yes.
    - **Explanation:** Autoruns lists all auto-starting locations and persistence mechanisms on Windows.

12. Analyze the returned entries for anomalous activity. Once completed, close Autoruns.

13. To view Sysmon events pertaining to the MCA, open Google Chrome, and select the Security Onion bookmark. Log in using credentials:
    - Username: trainee@jdmss.lan
    - Password: CyberTraining1!

14. Set the time period of interest as Aug 2, 2022 @ 09:20:00.000 to Aug 2, 2022 @ 09:25:00.000, and select Update.
    - **Explanation:** Sets the Kibana dashboard to only show logs from the specified time range.

15. Analyze the resulting data.
    - Look for infected hosts, suspicious files, executables run, persistence mechanisms, and IPs/ports used for communication.

---

## 2. Identify Infrastructure Vulnerabilities

**Workflow Steps:**
1. Log in to the Virtual Machine (VM) acas using the provided credentials:
   - Username: trainee
   - Password: CyberTraining1!

2. Open a Firefox web browser and select the bookmark Nessus.

3. From the left pane of the Nessus dashboard, select My Scans, then select Mission Partner's Network.

4. Analyze the information presented under the tab Hosts and the provided network map to pinpoint scanned hosts.

5. Select the tab Vulnerabilities and analyze more specific details.

6. Select the tab VPR Top Threats to analyze remediation efforts.
   - **Explanation:** VPR (Vulnerability Priority Rating) helps focus on the most critical threats.

7. Select the vulnerability MS17-010: Security Update for Microsoft Windows SMB Server, as highlighted, to display more information regarding the criticality of this vulnerability.
   - **Explanation:** This vulnerability is associated with the EternalBlue exploit.

---

## 3. Prioritize Vulnerabilities With Elastic Stack

**Workflow Steps:**
1. Log in to the VM kali-hunt using the provided credentials:
   - Username: trainee
   - Password: CyberTraining1!

2. Open a Firefox web browser and select the bookmark Security Onion.

3. Select the hamburger menu at the top left, then select Kibana in the section Tools.

4. Select Alert under Event Category in the Security Onion - Navigation pane.

5. In the field highlighted, set the time period from Sep 22, 2022 @ 10:00:00.000 to Sep 22, 2022 @ 13:00:00.000, then select Refresh.
   - **Explanation:** Focuses the analysis on events during a specific suspected incident window.

6. To analyze events using port 445, add the following filter then select Refresh:
   - **Filter:** destination.port: 445  
   - **Explanation:** Shows only traffic/events where the destination port is 445 (SMB).

7. To allocate SMB usage along with the exploit MS17-010, apply the following rules to the search:
   - **Filter:** event.severity_label.keyword: high AND rule.name.keyword: ET EXPLOIT Possible ETERNALBLUE Probe MS17-010 (MSF style)
   - **Explanation:** Shows only high-severity events where the rule name matches the identified exploit.

8. Analyze the fields destination.ip and message in the log at 12:33:11.272.

9. Remove the previous filter rule and replace it with the following rule:
   - **Filter:** rule.name.keyword: ET POLICY Powershell Activity Over SMB - Likely Lateral Movement  
   - **Explanation:** Detects lateral movement activity via PowerShell over SMB.

10. Analyze the field message in the log at 12:59:40.698.

---

## 4. IR in OT and IT Architecture | Part 1

**Workflow Steps:**
1. Open the Virtual Machine (VM) win-hunt. The login credentials are as follows:
   - Username: trainee
   - Password: CyberTraining1!

2. Open the Chrome web browser, select the Security Onion bookmark, and log in:
   - Username: trainee@jdmss.lan
   - Password: CyberTraining1!

3. Select the hamburger menu icon in the top left corner, and select Kibana in the Tools section.

4. Select the hamburger menu icon again, and select Discover in the Analytics section.

5. Set the time period of interest from Sep 29, 2022 @ 10:00:00.000 to Sep 29, 2022 @ 13:00:00.000, and select Update.

6. Use this Kibana Query Language (KQL) query to locate the network traffic associated with the host in the Business Processing Department, and select Update:
   - **KQL Query:** destination.ip: 172.16.3.2  
   - **Explanation:** Shows logs with destination IP matching the business workstation.

7. Analyze the log captured on Sep 29, 2022 @ 12:28:26.976.

8. Remove the previous KQL query, and use the new KQL query to search for the IP address of the PLC. Select Update:
   - **KQL Query:** source.ip: 172.16.80.10  
   - **Explanation:** Shows logs with source IP matching the PLC.

9. Add the following filter to analyze Modbus protocol traffic, and select Save:
   - **Filter:** event.dataset.keyword: modbus  
   - **Explanation:** Filters logs to only those using the Modbus protocol, typical for OT environments.

10. Analyze the log captured on Sep 29, 2022 @ 12:59:59:980.

---

## 5. IR in OT and IT Architecture | Part 2

**Workflow Steps:**
1. Remove the Modbus filter and KQL query that was set in the previous task, and add a new query, to include the following:
   - **KQL Query:** source.ip: 172.16.3.2 and destination.ip: 172.16.80.10  
   - **Explanation:** Shows traffic where the business workstation is talking directly to the PLC.

2. Analyze the log captured on Sep 29, 2022 @ 12:41:44.556. Notice the port and protocol used.

3. Select the hamburger menu icon, and select Dashboard under Analytics.

4. Select Network under Event Category.

5. Edit the KQL query search bar to include the IP address of the PLC in the query. Select Refresh:
   - **KQL Query:** event.category: network and source.ip: 172.16.80.10  
   - **Explanation:** Displays all network events originating from the PLC.

6. Analyze the Security Onion - Destination IP pane.

---

# Summary of Commands and Filters

- **Procmon64/Autoruns64/TCPView:**  
  - Used to observe process, persistence, and network activity on Windows.
  - Filters (like Process Name in Procmon or search in TCPView) allow you to zero in on malicious or suspicious activity.

- **Kibana/Elastic Stack Filters and Queries:**  
  - **destination.port: 445** – Focuses on SMB traffic.
  - **event.severity_label.keyword: high AND rule.name.keyword: ...** – Narrows view to high-severity events for a specific exploit (e.g., EternalBlue).
  - **rule.name.keyword: ...** – Finds specific detection rules, like lateral movement.
  - **destination.ip: [IP] / source.ip: [IP]** – Filters logs based on host IPs for incident tracing.
  - **event.dataset.keyword: modbus** – Restricts view to Modbus protocol traffic, common in OT.
  - **event.category: network** – Shows all network-related events.

---------------------------


